clc
clear
close all

i = 1:110;

e_bttle_eps = [
    446941
    497525
    415855
    418822
    457138
    463507
    452438
    604014
    430600
    476179
    407616
    416197
    434674
    441811
    419231
    427430
    442926
    396353
    417604
    449676
    495217
    452922
    397734
    452932
    325797
    365315
    361918
    405644
    392645
    362425
    386659
    339045
    393190
    396894
    421219
    375554
    392739
    353536
    388548
    340914
    389083
    356118
    409747
    360433
    510830
    386627
    347844
    363328
    358895
    362419
    352205
    353265
    450998
    391038
    404291
    352598
    428945
    480010
    337785
    455878
    423341
    363109
    405152
    338201
    410876
    392355
    384570
    379860
    341303
    379099
    349731
    376305
    367046
    362120
    410180
    399867
    349279
    418437
    451483
    365722
    350825
    391561
    330699
    351351
    378955
    351791
    374623
    415165
    395785
    366579
    375162
    343992
    359739
    359577
    342649
    425891
    396577
    350750
    375821
    338485
    381650
    376299
    346779
    381005
    378083
    369979
    346030
    381181
    370118
    351853
    ];

e_bttle_sh = [
    432899
    439376
    404448
    437930
    416354
    427561
    417761
    409362
    433781
    407385
    412232
    413792
    420643
    408293
    436403
    416599
    402773
    413616
    447275
    413723
    425703
    428529
    451397
    404523
    444197
    411579
    411636
    427198
    415387
    402399
    425909
    387404
    405075
    440540
    425009
    417338
    426806
    416525
    434309
    425401
    432399
    449352
    438308
    419494
    423299
    557126
    473472
    410544
    435255
    457917
    430259
    420217
    448046
    579834
    521920
    410633
    424843
    418843
    425293
    425529
    426250
    407815
    454778
    438576
    433541
    417174
    416172
    451914
    408818
    418004
    415288
    452771
    438840
    420666
    409786
    415491
    410011
    424849
    454870
    418405
    421665
    429431
    436158
    432496
    444411
    429268
    461816
    426456
    413837
    415568
    414137
    417283
    437715
    430161
    430950
    416984
    450371
    440163
    444296
    420363
    441004
    448152
    412710
    407506
    449276
    419608
    441187
    437145
    441439
    400682
    ];

exploring = [1
    2
    3
    4
    5
    6
    8
    10
    15
    17
    25
    27
    45
    56
    60
    76
    79
    96];

figure
plot(i, e_bttle_sh)
hold on
plot(i, e_bttle_eps)

e_bttle_eps_delta_mean = [];

disp(['i = ' num2str(length(e_bttle_sh)/10)])

delta_mean = 15;

for i = 1:(length(e_bttle_sh)/delta_mean)
    
    disp(['i = ' num2str(i)])
    
    e_bttle_eps_delta_mean((i-1)*delta_mean + 1 : (i-1)*delta_mean+delta_mean,1) = ...
        mean(e_bttle_eps((i-1)*delta_mean+1:(i-1)*delta_mean+delta_mean));
    
end

e_bttle_eps_delta_mean(end:end+5) = mean(e_bttle_eps(end-5:end));

% disp(e_bttle_eps_10_mean)
% disp(e_bttle_eps)

plot(e_bttle_eps_delta_mean)

% coeffs_eps = polyfit(i, e_bttle_eps', 1);
% coeffs_sh = polyfit(1:length(e_bttle_sh), e_bttle_sh', 1);
% xFitting = i; % Or wherever...
% yFitted_eps = polyval(coeffs_eps, xFitting);
% yFitted_sh = polyval(coeffs_sh, xFitting);
% plot(yFitted_eps);
% plot(yFitted_sh);

scatter(exploring,e_bttle_eps(exploring),'r')

% legend( 'SH', '\epsilon-MH', '\epsilon reg.', 'Explore')
grid on
xlabel('iteration')
ylabel('e_{bottleneck} [J]')

%% CUMULATED
%
% e_cum_eps = [
% 446941
% 944466
% 1215892
% 1589436
% 1971756
% 2435263
% 2838587
% 3248704
% 3630378
% 4036263
% 4375510
% 4790694
% 5196315
% 5638126
% 5993226
% 6420656
% 6789211
% 7185564
% 7603168
% 8052844
% 8548061
% 9000983
% 9398717
% 9851649
% 10177446
% 10530234
% 10880612
% 11265916
% 11606736
% 11958914
% 12324139
% 12662178
% 13055368
% 13439697
% 13860916
% 14220232
% 14608292
% 14945165
% 15295471
% 15632979
% 15984991
% 16341109
% 16750856
% 17107593
% 17472951
% 17857230
% 18190297
% 18553625
% 18886589
% 19244403
% 19595819
% 19949084
% 20363290
% 20754328
% 21130300
% 21394582
% 21823527
% 22257108
% 22591249
% 22979136
% 23353383
% 23704554
% 24109706
% 24447907
% 24858783
% 25251138
% 25635708
% 26010218
% 26344130
% 26723229
% 27063652
% 27439957
% 27807003
% 28153460
% 28539749
% 28915346
% 29260975
% 29679412
% 30079783
% 30445505
% 30788598
% 31180159
% 31507983
% 31859334
% 32224072
% 32560164
% 32927378
% 33342543
% 33723133
% 34069229
% 34421275
% 34762540
% 35122279
% 35465110
% 35804666
% 36228495
% 36625072
% 36965558
% 37334122
% 37672607
% 38054257
% 38430556
% 38777335
% 39158340
% 39536423
% 39879298
% 40221176
% 40602357
% 40972475
% 41368395
%
% ];
%
% e_cum_sh = [
%     432899
% 859330
% 1241001
% 1678931
% 2062138
% 2455832
% 2871729
% 3247059
% 3661790
% 4069175
% 4481407
% 4873526
% 5277994
% 5686287
% 6104274
% 6488611
% 6862400
% 7276016
% 7723291
% 8122381
% 8490876
% 8872076
% 9252358
% 9634630
% 10015543
% 10395954
% 10757098
% 11161961
% 11540846
% 11934336
% 12346649
% 12714573
% 13105721
% 13501894
% 13920984
% 14331302
% 14747620
% 15132301
% 15525611
% 15924703
% 16321793
% 16771145
% 17193316
% 17604507
% 17979688
% 18507926
% 18934760
% 19308086
% 19743341
% 20156807
% 20558492
% 20965381
% 21372203
% 21899233
% 22321648
% 22710070
% 23107304
% 23487371
% 23912664
% 24320264
% 24714917
% 25103573
% 25514621
% 25879746
% 26306201
% 26687385
% 27064462
% 27465127
% 27840711
% 28222667
% 28617408
% 29070179
% 29468629
% 29856475
% 30254201
% 30653509
% 31063520
% 31467215
% 31878645
% 32297050
% 32715369
% 33127202
% 33563360
% 33967129
% 34363134
% 34790698
% 35216943
% 35617401
% 36003151
% 36405795
% 36794634
% 37181230
% 37601370
% 38014208
% 38389659
% 38806643
% 39207907
% 39608337
% 40052633
% 40472996
% 40872166
% 41320318
% 41705900
% 42102281
% 42538179
% 42957787
% 43357240
% 43753087
% 44139629
% 44532434
% ];
%
% figure
% plot(i, e_cum_sh, 'LineWidth',1)
% hold on
% plot(i, e_cum_eps, 'LineWidth',1)
%
% x_axis_fill = 1:31;
% jbfill(x_axis_fill,e_cum_eps(x_axis_fill)',e_cum_sh(x_axis_fill)')
%
% x_axis_fill = 31:110;
% jbfill(x_axis_fill,e_cum_sh(x_axis_fill)',e_cum_eps(x_axis_fill)')
%
% grid on
% xlabel('iteration')
% ylabel('e_{cum} [J]')
% legend('SH', '\epsilon-MH')
%
% rho = 100 .* (e_cum_sh - e_cum_eps)./e_cum_sh;
% figure
% plot(i, rho)
% hold on
% plot(i, zeros(length(i)))
% grid on
% xlabel('iteration')
% ylabel('\rho [%]')
% %  = (e_{cum}^{SH} - e_{cum}^{MH}) / e_{cum}^{SH}
% area(1:3, rho(1:3))
% area(3:21, rho(3:21))
% area(21:31, rho(21:31))
% area(31:110, rho(31:110))


%% SAVING RATIO CURVE IS INTERESTING :D

